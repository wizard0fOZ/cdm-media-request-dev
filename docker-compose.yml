services:
  # ---------- Your MySQL ----------
  mysql:
    image: mysql:8.4
    container_name: local_mysql_dev
    restart: unless-stopped
    environment:
      MYSQL_DATABASE: appdb_dev
      MYSQL_USER: appuser
      MYSQL_PASSWORD: apppass123
      MYSQL_ROOT_PASSWORD: rootpass123
      TZ: Asia/Kuala_Lumpur
    ports:
      - "3308:3306"
    volumes:
      - ./db/init:/docker-entrypoint-initdb.d:ro
      - mysql_data_dev:/var/lib/mysql

  # ---------- Adminer ----------
  adminer:
    image: adminer:latest
    container_name: adminer_dev
    restart: unless-stopped
    ports:
      - "8082:8080"
    depends_on:
      - mysql

  # ---------- PHP Public Form (Apache + PHP 8.4) ----------
  php:
    build:
      context: .
      dockerfile: docker/php/DockerFile
    container_name: mrapp_php_dev
    restart: unless-stopped
    ports:
      - "8001:80"
    volumes:
      - ./apps/public-form:/var/www/app
      - ./apps/public-form/storage:/var/www/storage
    environment:
      TZ: Asia/Kuala_Lumpur
      DB_HOST: mysql
      DB_PORT: 3306
      DB_NAME: appdb_dev
      DB_USER: appuser
      DB_PASS: apppass123
    depends_on:
      - mysql

  # ---------- Email Testing (Mailpit) ----------
  mailpit:
    image: axllent/mailpit:latest
    container_name: mailpit_dev
    restart: unless-stopped
    ports:
      - "1026:1025"
      - "8026:8025"

volumes:
  # Yours
  mysql_data_dev:
